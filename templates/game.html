{% extends 'base.html' %}

{% block content %}
    <h1>Game of {{ game.nickname }}</h1>
    <table class="table table-bordered bg-white">
        <caption>Game info</caption>
        <tbody>
        <tr>
            <th scope="row">Amount of colors</th>
            <td>{{ game.amount_of_colors }}</td>
        </tr>
        <tr>
            <th scope="row">Amount of positions</th>
            <td>{{ game.amount_of_positions }}</td>
        </tr>
        <tr>
            <th scope="row">Amount of guesses</th>
            <td>{{ game.amount_of_guesses }}</td>
        </tr>
        <tr>
            <th scope="row">Can have double colors</th>
            <td>{{ game.can_have_double_colors }}</td>
        </tr>
        </tbody>
    </table>
    <table class="table table-bordered bg-white">
        <caption>Board</caption>
        <thead>
        <tr>
            <th scope="col">Guess</th>
            <th scope="col">Result</th>
        </tr>
        </thead>
        <tbody>
        {% for _ in range(game.amount_of_guesses - game.guesses|length) -%}
            <tr>
                <th scope="row"></th>
                <td></td>
            </tr>
        {% endfor %}
        {% for guess, result in game.guesses|reverse -%}
            <tr>
                <th scope="row">
                    {% for g in guess -%}
                        <div class="circle border border-dark rounded-circle d-inline-block" style="background-color: {{ g }};">
                        </div>
                    {% endfor %}
                </th>
                <td>
                    {% for correct in result if correct != Correct.INCORRECT -%}
                        <div class="circle border border-dark rounded-circle d-inline-block"
                            style="background-color: {{ "black" if correct == Correct.CORRECT else "white" }};">
                        </div>
                    {% endfor %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    {% if not game.has_won() %}
        <form action="{{ url_for('submit_guess', game_id=game_id) }}" method="POST">
            <div class="d-flex gap-3">
                {% for i in range(game.amount_of_positions) -%}
                <select class="form-select" aria-label="Select color" name="{{ i }}">
                    {% for n in range(game.amount_of_colors) -%}
                    <option value="{{ n }}">{{ n|color }}</option>
                    {% endfor %}
                </select>
                {% endfor %}
            </div>

            <button class="btn btn-secondary my-3" type="submit">Guess</button>
        </form>
    {% endif %}

{% endblock %}